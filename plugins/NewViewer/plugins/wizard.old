#!/bin/bash
# Check arguments
if [ $# != 2 ]; then
    echo "Usage: wizard <sourceClass> <targetClass>"  
    echo 
    echo "Example:"
    echo "    wizard Template MyPlugin"
    exit -1
fi
# Class & Folder names
sourceClass=$1
targetClass=$2
sourceFolder=$(echo $sourceClass | tr '[:upper:]' '[:lower:]')
targetFolder=$(echo $targetClass | tr '[:upper:]' '[:lower:]')
sourceName=$sourceFolder
targetName=$targetFolder

# Check sourceFolder does exists
if [ -d $sourceFolder ]; then
	echo " Source folder: " $sourceFolder 
else 
	echo " Error: source folder does not exists: " $sourceFolder 
    echo " Exiting..."
    exit -1
fi 
# Check targetFolder does not exists
if [ -d $targetFolder ]; then
	echo " Error: Target folder already exists: " $targetFolder 
    echo " Exiting..."
    exit -1
else 
	echo " Target folder: " $targetFolder 
fi 

#read -p "--Enter a name for the new class (example: AnimateVertices): " className
#read -p "--Enter an existing plugin to copy from (default: Template): " className
#libName=$(echo $className | tr '[:upper:]' '[:lower:]')
#dirName=$libName
echo " Creating folder: " $targetFolder
mkdir $targetFolder
cat $sourceFolder/*.cpp  | sed s/$sourceFolder/$targetFolder/   | sed s/$sourceFolder/$targetFolder/ |  sed s/$sourceClass/$targetClass/ |  sed s/$sourceClass/$targetClass/  >$targetFolder/$targetName.cpp
cat $sourceFolder/*.h    | sed s/$sourceFolder/$targetFolder/   |  sed s/$sourceClass/$targetClass/  >$targetFolder/$targetName.h
cat $sourceFolder/*.vert | sed s/$sourceFolder/$targetFolder/   |  sed s/$sourceClass/$targetClass/  >$targetFolder/$targetName.vert
cat $sourceFolder/*.geom | sed s/$sourceFolder/$targetFolder/   |  sed s/$sourceClass/$targetClass/  >$targetFolder/$targetName.geom
cat $sourceFolder/*.frag | sed s/$sourceFolder/$targetFolder/   |  sed s/$sourceClass/$targetClass/  >$targetFolder/$targetName.frag
cat $sourceFolder/*.pro  | sed s/$sourceFolder/$targetFolder/   |  sed s/$sourceClass/$targetClass/  >$targetFolder/$targetName.pro
files=$(ls $targetFolder)
echo "--Created files: " $files
echo "--Compiling..."
cd $targetFolder
qmake
make
../../viewer/bin/viewer




